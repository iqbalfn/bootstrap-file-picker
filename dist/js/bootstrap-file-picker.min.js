/*!
  * Bootstrap File Picker v0.0.3 (https://iqbalfn.github.io/bootstrap-file-picker/)
  * Copyright 2019 Iqbal Fauzi
  * Licensed under MIT (https://github.com/iqbalfn/bootstrap-file-picker/blob/master/LICENSE)
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jquery")):"function"==typeof define&&define.amd?define(["exports","jquery"],t):t((e=e||self)["bootstrap-file-picker"]={},e.jQuery)}(this,function(e,h){"use strict";h=h&&h.hasOwnProperty("default")?h.default:h;var i={multiple:!1,type:"*/*",btnUpload:"Upload",thumbnails:null,search:null,upload:null,selected:null},t=function(){function e(e){this._config=this._getConfig(e),this._el={},this._files=[],this._items=[],this._paths=[],this._query="",this._uploader=0,this._timer=null,this._makeDrawer(),this._addElementsListener(),h(this._el.drawer).drawer("show")}var t=e.prototype;return t._addElementsListener=function(){var a=this;h(this._el.drawer).on("show.bs.drawer",function(e){a._footerHide()}),h(this._el.drawer).on("shown.bs.drawer",function(e){if(a._el.dhSearchInput){var t=a._el.dhSearchInput.offsetWidth,r=parseFloat(h(a._el.dhSearchInput).css("padding-left"));a._el.dhSearchSpinner.style.left=t-2.5*r+"px",a._spinnerHide(),a._el.dhSearchInput.focus()}a._searchQuery("")}),h(this._el.drawer).on("hide.bs.drawer",function(e){a._uploader&&e.preventDefault()}),h(this._el.drawer).on("hidden.bs.drawer",function(e){h(a._el.drawer).remove()}),this._el.dhSearchInput&&h(this._el.dhSearchInput).on("input",function(e){a._timer&&clearTimeout(a._timer),a._query=a._el.dhSearchInput.value,a._timer=setTimeout(function(e){return a._searchQuery(e)},500,a._query)}),h(this._el.drawerBody).on("click",".filepicker-item-selectable",function(e){var t=e.currentTarget;a._config.multiple||h(a._el.drawerBody).children(".filepicker-item-active").removeClass("filepicker-item-active");var r=h(t).data("filepicker.item").path;t.classList.toggle("filepicker-item-active")?a._paths.push(r):a._paths.splice(a._paths.indexOf(r),1),a._footerUpdate()}),h(this._el.drawerBody).on("click",".filepicker-item-error",function(e){var t=e.currentTarget;t.style.opacity=0,setTimeout(function(e){return h(e).remove()},300,t)}),h(this._el.dfBtnSelect).click(function(e){var r=[];h(a._el.drawerBody).children(".filepicker-item-active").each(function(e,t){return r.push(h(t).data("filepicker.item"))}),a._config.selected&&a._config.selected.call(a,r),h(a._el.drawer).drawer("hide")}),this._el.dhUploadInput&&h(this._el.dhUploadInput).on("change",function(e){var n=a._el.dhUploadInput.files;if(n.length){a._clearResult();for(var t=function(e){var t=n[e],r=a._renderItem(t,!0,null,!1,!1),i=h(r).find(".progress-bar").get(0);a._uploader++,a._footerUpdate(),a._config.upload.call(a,t,i,function(e){if(a._uploader--,"string"==typeof e)e=a._hs(e),h(i).parent().replaceWith('<small class="text-danger">'+e+"</small>"),r.classList.add("filepicker-item-error");else{var t=a._renderItem(e,!1,r,!1,!0);t?t.click():h(r).remove()}a._footerUpdate()})},r=0;r<n.length;r++)t(r);a._el.dhUploadForm.reset()}})},t._clearResult=function(){h(this._el.drawerBody).find(".filepicker-item-clearable").not(".filepicker-item-active").each(function(e,t){return h(t).remove()}),this._footerUpdate()},t._getConfig=function(e){var t={};for(var r in i)t[r]="undefined"==typeof e[r]?i[r]:e[r];return t},t._hs=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},t._makeDrawer=function(){var i=this,e="",t=this._config.multiple?" multiple":"";if(this._config.search){var r="";this._config.upload&&(r='\n                    <form class="input-group-append" data-el="dh-upload-form">\n                        <label class="btn btn-outline-secondary" data-el="dh-upload-label">\n                            <input type="file" accept="'+this._config.type+'" data-el="dh-upload-input"'+t+">\n                        </label>\n                    </form>"),e='\n                <div class="form-group">\n                    <div class="input-group">\n                        <input type="search" class="form-control" placeholder="Search" aria-label="Search" data-el="dh-search-input">\n                        '+r+'\n                    </div>\n                    <div class="spinner-border spinner-border-sm text-secondary" role="status" data-el="dh-search-spinner"></div>\n                </div>'}else this._config.upload&&(e='\n                <form data-el="dh-upload-form">\n                    <label class="btn btn-block btn-outline-primary" data-el="dh-upload-label">\n                        <input type="file" accept="'+this._config.type+'" data-el="dh-upload-input"'+t+">\n                    </label>\n                </form>");var n='\n            <div class="drawer slide drawer-right filepicker-container">\n                <div class="drawer-content drawer-content-scrollable">\n                    <div class="drawer-header">'+e+'</div>\n                    <div class="drawer-body" data-el="drawer-body"></div>\n                    <div class="drawer-footer" data-el="drawer-footer">\n                        <button class="btn btn-primary btn-block" data-el="df-btn-select">\n                            Select\n                        </button>\n                    </div>\n                </div>\n            </div>';this._el.drawer=h(n).appendTo(document.body).get(0),h(this._el.drawer).find("[data-el]").each(function(e,t){var r=t.dataset.el.replace(/\-[a-z]/g,function(e){return e[1].toUpperCase()});i._el[r]=t}),h(this._el.dhUploadLabel).append(this._config.btnUpload)},t._renderItem=function(e,t,r,i,n){if(void 0===t&&(t=!1),void 0===r&&(r=null),void 0===i&&(i=!0),void 0===n&&(n=!0),t||!this._paths.includes(e.path)){var a={name:this._hs(e.name),type:this._hs(e.type),thumb:e.thumb||this._config.thumbnails},l=" filepicker-item",s="";t&&(l+=" filepicker-item-uploader",s='\n                <div class="progress">\n                    <div class="progress-bar progress-bar-striped progress-bar-animated" style="width:0%"></div>\n                </div>'),i&&(l+=" filepicker-item-clearable"),n&&(l+=" filepicker-item-selectable");var d=h('\n            <div class="media'+l+'" title="'+a.name+'">\n                <img src="'+a.thumb+'" alt="#" width="48" height="48">\n                <div class="media-body">\n                    <h6>'+a.name+'</h6>\n                    <small class="text-muted">'+a.type+"</small>\n                    "+s+"\n                </div>\n            </div>").get(0);if(t){var o=h(d).children("img").get(0);if(/image\//.test(a.type)){var c=new FileReader;c.onload=function(e){return o.src=e.target.result},c.readAsDataURL(e)}}else h(d).data("filepicker.item",e);return r?h(r).replaceWith(d):h(this._el.drawerBody).append(d),d}},t._searchQuery=function(t){var r=this;this._clearResult(),this._spinnerShow(),this._config.search&&this._config.search(t,this._config.type,function(e){t==r._query&&(r._spinnerHide(),e&&e.forEach(function(e){return r._renderItem(e)}))})},t._footerHide=function(){this._el.drawerFooter.style.display="none"},t._footerShow=function(){this._el.drawerFooter.style.display="flex"},t._footerUpdate=function(){if(this._uploader)return this._footerHide();h(this._el.drawerBody).children(".filepicker-item-active").length?this._footerShow():this._footerHide()},t._spinnerHide=function(){this._el.dhSearchSpinner&&(this._el.dhSearchSpinner.style.display="none")},t._spinnerShow=function(){this._el.dhSearchSpinner&&(this._el.dhSearchSpinner.style.display="block")},e}();window.FilePicker=t,e.FilePicker=t,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=bootstrap-file-picker.min.js.map